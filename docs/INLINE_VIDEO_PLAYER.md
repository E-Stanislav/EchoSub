# –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä EchoSub

## üé¨ –û–±–∑–æ—Ä

–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä EchoSub –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –≤–∏–¥–µ–æ –ø—Ä—è–º–æ –≤ –æ–∫–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–Ω–µ—à–Ω–∏—Ö –æ–∫–æ–Ω. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–∫–∞–¥—Ä–æ–≤—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ FFmpeg –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏—Ö –≤ Fyne canvas.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ** - –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –æ–∫–æ–Ω
- **–ü–æ–∫–∞–¥—Ä–æ–≤—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** - —á–µ—Ä–µ–∑ FFmpeg
- **–ö–æ–Ω—Ç—Ä–æ–ª—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è** - Play/Pause/Stop
- **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** - —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–º–æ—Ç–∫–∏
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** - —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è / –æ–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞** - –≤–∏–¥–µ–æ –∏–ª–∏ –∞—É–¥–∏–æ
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å UI** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### üîÑ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:
- –ê—É–¥–∏–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –¥–ª—è –≤–∏–¥–µ–æ
- –ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
MediaView (UI)
    ‚Üì
InlineVideoPlayer (–ª–æ–≥–∏–∫–∞)
    ‚Üì
FFmpeg (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤)
    ‚Üì
Fyne Canvas (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### InlineVideoPlayer (`internal/media/inline_player.go`)
```go
type InlineVideoPlayer struct {
    mediaFile    *MediaFile
    framesDir    string
    frameRate    float64
    totalFrames  int
    currentFrame int
    isPlaying    bool
    isPaused     bool
    position     time.Duration
    duration     time.Duration
    // ... callbacks –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
}
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MediaView
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ (–≤–∏–¥–µ–æ/–∞—É–¥–∏–æ)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–ª–µ–µ—Ä–∞ –¥–ª—è –≤–∏–¥–µ–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ã—á–Ω–æ–≥–æ –ø–ª–µ–µ—Ä–∞ –¥–ª—è –∞—É–¥–∏–æ
- –ï–¥–∏–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã –¥–ª—è –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤

### –ü—Ä–æ—Ü–µ—Å—Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞:**
   ```go
   videoPlayer.LoadVideo(mediaFile)
   ```

2. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤:**
   ```bash
   ffmpeg -i video.mp4 -vf fps=10 -q:v 2 frame_%04d.png
   ```

3. **–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ:**
   - –ß—Ç–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –ø–æ —Ç–∞–π–º–µ—Ä—É
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ canvas.Image
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI —á–µ—Ä–µ–∑ callbacks

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
./echosub

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª:
# - –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ MP4/MKV/MOV –≤ –æ–∫–Ω–æ
# - –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ '–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª' –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–µ–æ
```

### 2. –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ:
- **‚ñ∂ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏** - –Ω–∞—á–∏–Ω–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤ –æ–∫–Ω–µ
- **‚è∏ –ü–∞—É–∑–∞** - –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
- **‚èπ –°—Ç–æ–ø** - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫ –Ω–∞—á–∞–ª—É
- **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** - –ø–µ—Ä–µ–º–æ—Ç–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### 3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –í–∏–¥–µ–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ–∫–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ö–∞–¥—Ä—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å —á–∞—Å—Ç–æ—Ç–æ–π 10 FPS
- –í—Ä–µ–º—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üìã –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

### –í–∏–¥–µ–æ (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–ª–µ–µ—Ä):
- **MP4** - MPEG-4 Part 14
- **MKV** - Matroska Video
- **MOV** - QuickTime Movie

### –ê—É–¥–∏–æ (–æ–±—ã—á–Ω—ã–π –ø–ª–µ–µ—Ä):
- **MP3** - MPEG Audio Layer III
- **WAV** - Waveform Audio File Format
- **M4A** - MPEG-4 Audio
- **FLAC** - Free Lossless Audio Codec

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- **FFmpeg** - –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤
- **Go 1.23+** - –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- **Fyne 2.6** - –¥–ª—è GUI

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ FFmpeg
ffmpeg -version

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤
ffmpeg -i test_video.mp4 -vf fps=10 -q:v 2 -y test_frame.png
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
./scripts/test_ffmpeg.sh

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–ª–µ–µ—Ä–∞
./scripts/test_inline_player.sh
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `./echosub`
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ: `test_video.mp4`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –ø–ª–µ–µ—Ä–∞
4. –ù–∞–∂–º–∏—Ç–µ "‚ñ∂ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏"
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤ –æ–∫–Ω–µ
6. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–æ—Ç–∫—É —á–µ—Ä–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- 10 FPS –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞ (–º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å)
- –ù–µ—Ç –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è

### 2. –ê—É–¥–∏–æ
- –í–∏–¥–µ–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –±–µ–∑ –∑–≤—É–∫–∞
- –î–ª—è –∞—É–¥–∏–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä
- –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞—É–¥–∏–æ

### 3. –ü–∞–º—è—Ç—å
- –ö–∞–¥—Ä—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –î–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏

## üöÄ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (v1.1):
- [ ] –ê—É–¥–∏–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –¥–ª—è –≤–∏–¥–µ–æ
- [ ] –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∫–∞–¥—Ä–æ–≤ (–¥–æ 30 FPS)
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –≤ –ø–∞–º—è—Ç–∏

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (v1.2):
- [ ] –ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ CGo
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
- [ ] –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (v2.0):
- [ ] –ü–æ—Ç–æ–∫–æ–≤–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 4K/8K
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- **–ß–∞—Å—Ç–æ—Ç–∞ –∫–∞–¥—Ä–æ–≤:** 10 FPS
- **–ö–∞—á–µ—Å—Ç–≤–æ:** -q:v 2 (–≤—ã—Å–æ–∫–æ–µ)
- **–§–æ—Ä–º–∞—Ç –∫–∞–¥—Ä–æ–≤:** PNG
- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏:** ~1-5 —Å–µ–∫—É–Ω–¥ –¥–ª—è 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ –≤–∏–¥–µ–æ

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –≤ —Ñ–æ–Ω–µ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –º—å—é—Ç–µ–∫—Å—ã

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å—Ç–æ—Ç—ã –∫–∞–¥—Ä–æ–≤:
```go
// –í inline_player.go
"-vf", "fps=10", // –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ fps=30 –¥–ª—è –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞:
```go
// –í inline_player.go
"-q:v", "2", // 1-31, –≥–¥–µ 1 - –ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, 31 - —Ö—É–¥—à–µ–µ
```

### –í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:
```go
// –ö–∞–¥—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
os.TempDir() + "/echosub-frames-*"
``` 